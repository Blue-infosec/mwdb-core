import React, {Component} from 'react';
import MultiRelationsBox from './Relations';
import CommentBox from './Comments';
import TagBox from './Tag';
import ShareBox from "./Shares";
import MetakeyBox from "./Metakeys";
import { connect } from 'react-redux';
import { Extendable } from '@malwarefront/ui';

class ShowObject extends Component {
    render() {
        let ObjectPresenter = this.props.objectPresenterComponent;

        return (
            <div className="card-body">
                <Extendable ident="showObject" object={this.props.object}>
                    <div className="row">
                        <div className="col-md-7">
                            <Extendable ident="showObjectLeftColumn" object={this.props.object}>
                                <div className="card">
                                    <Extendable ident="showObjectPresenter" object={this.props.object}>
                                        <ObjectPresenter {...this.props.object} />
                                    </Extendable>
                                </div>
                                { this.props.children }
                                <ShareBox id={this.props.object.id} />
                            </Extendable>
                        </div>

                        <div className="col-md-5">
                            <Extendable ident="showObjectRightColumn" object={this.props.object}>
                                <TagBox id={this.props.object.id}/>
                                <MultiRelationsBox parents={this.props.object.parents} children={this.props.object.children}/>
                                {
                                    this.props.canSeeMetakeys ?
                                    <MetakeyBox id={this.props.object.id}/> : []
                                }
                                <CommentBox id={this.props.object.id}/>
                            </Extendable>
                        </div>
                    </div>
                </Extendable>
            </div>
        );
    }
}

function mapStateToProps(state, ownProps)
{
    return {
        ...ownProps,
        canSeeMetakeys: state.auth.loggedUser.capabilities.includes("reading_attributes")
    }
}

export default connect(mapStateToProps)(ShowObject);
