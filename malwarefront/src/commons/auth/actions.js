import authActionTypes from "./types";
import authService from "./service";

import { push } from "connected-react-router";

function login(username, password, navPath) {
    return dispatch => {
        dispatch({ type: authActionTypes.LOGIN_REQUEST, username })
        authService.login(username, password)
            .then(user => {
                dispatch({ type: authActionTypes.LOGIN_SUCCESS, user: user, navPath: null });
                dispatch(push(navPath || "/"));
            })
            .catch(error => dispatch({ type: authActionTypes.LOGIN_FAILURE, error }))
    }
}

function logout(error, navPath) {
    authService.logout();
    return { type: authActionTypes.LOGOUT, error, navPath };
}

export default { login, logout };